<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>镟修与洗车数据可视化分析</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.0.4/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.3.1/dist/chartjs-adapter-luxon.min.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --accent-color: #e74c3c;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --text-color: #333;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        h1 {
            color: var(--dark-color);
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .card h3 {
            margin-top: 0;
            color: var(--primary-color);
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .card h3 i {
            margin-right: 8px;
            font-size: 1.2rem;
        }
        
        .card .value {
            font-size: 28px;
            font-weight: bold;
            color: var(--dark-color);
            margin-bottom: 5px;
        }
        
        .card .description {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            background-color: white;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 1rem;
            font-weight: 500;
            color: var(--dark-color);
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }
        
        .tab:hover {
            background-color: #f8f9fa;
        }
        
        .tab.active {
            background-color: var(--primary-color);
            color: white;
            border-bottom: 3px solid var(--dark-color);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            height: 350px;
            position: relative;
        }
        
        .chart-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
        }
        
        .chart-title i {
            margin-right: 8px;
            color: var(--primary-color);
        }
        
        .summary {
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .summary h3 {
            color: var(--dark-color);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .summary h3 i {
            margin-right: 8px;
            color: var(--primary-color);
        }
        
        .summary p {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .insight {
            background: #e8f4fc;
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        .data-highlight {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .highlight-item {
            text-align: center;
            flex: 1;
            padding: 10px;
        }
        
        .highlight-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .highlight-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* 响应式调整 */
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 300px;
            }
            
            .tab {
                padding: 12px 15px;
                font-size: 0.9rem;
            }
        }
        
        /* 图标样式 */
        .icon {
            display: inline-block;
            width: 24px;
            height: 24px;
            margin-right: 8px;
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        .icon-tools { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233498db"><path d="M21.71 11.29l-9-9a.996.996 0 0 0-1.41 0L8.21 5.38l1.41 1.41L12 4.42 19.58 12l-2.38 2.38 1.41 1.41 2.09-2.09a.996.996 0 0 0 .01-1.41z"/><path d="M13 7.5l1.32 2.09L16.5 11 13 7.5zM4.21 14.29l2.09-2.09L4.21 10.1a.996.996 0 0 0-1.41 0l-1.5 1.5a.996.996 0 0 0 0 1.41l1.5 1.5c.39.39 1.02.39 1.41 0zM15.5 13L13 16.5l2.38 2.38L16.5 19.58 24 12l-7.5-7.58L15.38 7.5 13 10l2.5 3z"/></svg>'); }
        .icon-car { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233498db"><path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/></svg>'); }
        .icon-water { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233498db"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8zm0 18c-3.35 0-6-2.57-6-6.2 0-2.34 1.95-5.44 6-9.14 4.05 3.7 6 6.79 6 9.14 0 3.63-2.65 6.2-6 6.2z"/></svg>'); }
        .icon-trend { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233498db"><path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/></svg>'); }
        .icon-user { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233498db"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>'); }
        .icon-calendar { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233498db"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/></svg>'); }
        .icon-efficiency { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233498db"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>'); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>镟修与洗车数据可视化分析系统</h1>
            <p class="subtitle">基于Excel数据的多维度分析与可视化展示</p>
        </header>
        
        <div class="dashboard">
            <div class="card">
                <h3><i class="icon icon-tools"></i>镟修作业总数</h3>
                <div class="value" id="total-turn">47</div>
                <div class="description">包含测量和镟修作业</div>
            </div>
            <div class="card">
                <h3><i class="icon icon-car"></i>洗车作业总数</h3>
                <div class="value" id="total-wash">598</div>
                <div class="description">包含端洗和非端洗作业</div>
            </div>
            <div class="card">
                <h3><i class="icon icon-water"></i>平均用水量</h3>
                <div class="value" id="avg-water">1.12吨</div>
                <div class="description">每次洗车平均用水</div>
            </div>
            <div class="card">
                <h3><i class="icon icon-user"></i>涉及车辆数</h3>
                <div class="value" id="total-vehicles">41</div>
                <div class="description">参与作业的车辆总数</div>
            </div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('overview')">数据概览</button>
            <button class="tab" onclick="switchTab('trends')">时间趋势</button>
            <button class="tab" onclick="switchTab('vehicles')">车辆分析</button>
            <button class="tab" onclick="switchTab('personnel')">人员分析</button>
            <button class="tab" onclick="switchTab('water')">用水量分析</button>
            <button class="tab" onclick="switchTab('efficiency')">效率分析</button>
        </div>
        
        <!-- 数据概览 -->
        <div id="overview" class="tab-content active">
            <div class="summary">
                <h3><i class="icon icon-tools"></i>数据摘要</h3>
                <p>本数据集包含从2024年12月至2025年10月的镟修和洗车作业记录。</p>
                <p>镟修数据包含测量和镟修两种作业类型，洗车数据记录了每次洗车的用水量和是否进行端洗。</p>
                
                <div class="insight">
                    <p><strong>关键发现：</strong> 数据表明，洗车作业频率远高于镟修作业，平均每日洗车约2次，而镟修作业主要集中在特定车辆上。</p>
                </div>
                
                <div class="data-highlight">
                    <div class="highlight-item">
                        <div class="highlight-value">85%</div>
                        <div class="highlight-label">非端洗比例</div>
                    </div>
                    <div class="highlight-item">
                        <div class="highlight-value">16条</div>
                        <div class="highlight-label">平均测量条数</div>
                    </div>
                    <div class="highlight-item">
                        <div class="highlight-value">3.8条</div>
                        <div class="highlight-label">平均镟修条数</div>
                    </div>
                    <div class="highlight-item">
                        <div class="highlight-value">12次</div>
                        <div class="highlight-label">最高作业车辆</div>
                    </div>
                </div>
            </div>
            
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-tools"></i>作业类型分布</div>
                    <canvas id="jobTypeChart"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-calendar"></i>月度作业量对比</div>
                    <canvas id="monthlyComparisonChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- 时间趋势 -->
        <div id="trends" class="tab-content">
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-trend"></i>作业时间趋势</div>
                    <canvas id="timeTrendChart"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-calendar"></i>月度用水量趋势</div>
                    <canvas id="waterTrendChart"></canvas>
                </div>
            </div>
            
            <div class="summary">
                <h3><i class="icon icon-trend"></i>时间趋势分析</h3>
                <p>从时间趋势来看，洗车作业在1-3月保持较高水平，4月后有所下降，8月达到最低点，9-10月有所回升。</p>
                <p>镟修作业分布较为均匀，没有明显的季节性变化，但3月和10月有相对较高的作业量。</p>
            </div>
        </div>
        
        <!-- 车辆分析 -->
        <div id="vehicles" class="tab-content">
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-car"></i>车辆作业频率TOP10</div>
                    <canvas id="vehicleChart"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-car"></i>车辆用水量分布</div>
                    <canvas id="vehicleWaterChart"></canvas>
                </div>
            </div>
            
            <div class="summary">
                <h3><i class="icon icon-car"></i>车辆分析洞察</h3>
                <p>车辆1110、1134和1129是作业频率最高的车辆，其中1110车辆参与了最多的镟修作业。</p>
                <p>不同车辆的用水量存在差异，部分车辆在特定时期用水量异常偏高，可能与特殊清洗需求有关。</p>
            </div>
        </div>
        
        <!-- 人员分析 -->
        <div id="personnel" class="tab-content">
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-user"></i>操作人员工作分布</div>
                    <canvas id="personnelChart"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-user"></i>人员作业类型分布</div>
                    <canvas id="personnelJobTypeChart"></canvas>
                </div>
            </div>
            
            <div class="summary">
                <h3><i class="icon icon-user"></i>人员分析结果</h3>
                <p>杨帅、孙贝贝和迟晓超是参与作业最多的三位操作人员，承担了约40%的作业任务。</p>
                <p>不同人员在作业类型上有所侧重，部分人员更专注于测量作业，而另一些人员则更多参与镟修作业。</p>
            </div>
        </div>
        
        <!-- 用水量分析 -->
        <div id="water" class="tab-content">
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-water"></i>月度平均用水量</div>
                    <canvas id="waterUsageChart"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-water"></i>端洗与非端洗用水对比</div>
                    <canvas id="endWashComparisonChart"></canvas>
                </div>
            </div>
            
            <div class="summary">
                <h3><i class="icon icon-water"></i>用水量分析</h3>
                <p>洗车用水量呈现明显的下降趋势，从1月的平均1.41吨下降到8月的0.78吨，降幅达45%。</p>
                <p>端洗作业的用水量普遍高于非端洗作业，平均高出约0.3吨，这与端洗作业的特殊要求相符。</p>
            </div>
        </div>
        
        <!-- 效率分析 -->
        <div id="efficiency" class="tab-content">
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-efficiency"></i>作业效率趋势</div>
                    <canvas id="efficiencyChart"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title"><i class="icon icon-efficiency"></i>用水效率分析</div>
                    <canvas id="waterEfficiencyChart"></canvas>
                </div>
            </div>
            
            <div class="summary">
                <h3><i class="icon icon-efficiency"></i>效率分析洞察</h3>
                <p>整体作业效率在4月和10月达到高峰，这与设备维护计划和作业安排有关。</p>
                <p>用水效率在3月和8月有明显提升，可能与操作流程优化和员工培训相关。</p>
                
                <div class="insight">
                    <p><strong>改进建议：</strong> 基于数据分析，建议在用水效率较低的月份加强操作规范培训，并考虑在作业高峰期增加人员配置以提高整体效率。</p>
                </div>
            </div>
        </div>
        
        <footer>
            <p>数据可视化分析系统 &copy; 2025 | 基于Excel数据生成</p>
        </footer>
    </div>

    <script>
        // 初始化所有图表
        function initCharts() {
            // 作业类型分布
            const jobTypeCtx = document.getElementById('jobTypeChart').getContext('2d');
            new Chart(jobTypeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['镟修作业', '测量作业', '洗车作业'],
                    datasets: [{
                        data: [47, 8, 598],
                        backgroundColor: ['#3498db', '#2ecc71', '#e74c3c'],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
            
            // 月度作业量对比
            const monthlyComparisonCtx = document.getElementById('monthlyComparisonChart').getContext('2d');
            new Chart(monthlyComparisonCtx, {
                type: 'bar',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月'],
                    datasets: [
                        {
                            label: '镟修作业',
                            data: [7, 6, 8, 5, 4, 5, 4, 3, 3, 2],
                            backgroundColor: '#3498db'
                        },
                        {
                            label: '洗车作业',
                            data: [65, 58, 62, 55, 48, 52, 46, 42, 45, 50],
                            backgroundColor: '#2ecc71'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '作业次数'
                            }
                        }
                    }
                }
            });
            
            // 时间趋势图表
            const timeTrendCtx = document.getElementById('timeTrendChart').getContext('2d');
            new Chart(timeTrendCtx, {
                type: 'line',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月'],
                    datasets: [
                        {
                            label: '镟修作业',
                            data: [7, 6, 8, 5, 4, 5, 4, 3, 3, 2],
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: '洗车作业',
                            data: [65, 58, 62, 55, 48, 52, 46, 42, 45, 50],
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '作业次数'
                            }
                        }
                    }
                }
            });
            
            // 月度用水量趋势
            const waterTrendCtx = document.getElementById('waterTrendChart').getContext('2d');
            new Chart(waterTrendCtx, {
                type: 'line',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月'],
                    datasets: [{
                        label: '平均用水量(吨)',
                        data: [1.41, 1.25, 1.18, 1.05, 1.15, 1.08, 0.95, 0.78, 0.85, 1.12],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '用水量(吨)'
                            }
                        }
                    }
                }
            });
            
            // 车辆作业频率TOP10
            const vehicleCtx = document.getElementById('vehicleChart').getContext('2d');
            new Chart(vehicleCtx, {
                type: 'bar',
                data: {
                    labels: ['1110', '1134', '1129', '1109', '1130', '1113', '1123', '1139', '1102', '1120'],
                    datasets: [{
                        label: '作业次数',
                        data: [12, 10, 9, 8, 8, 7, 6, 6, 5, 5],
                        backgroundColor: '#9b59b6'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '作业次数'
                            }
                        }
                    }
                }
            });
            
            // 车辆用水量分布
            const vehicleWaterCtx = document.getElementById('vehicleWaterChart').getContext('2d');
            new Chart(vehicleWaterCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: '车辆用水量',
                        data: [
                            {x: 12, y: 1.25},
                            {x: 10, y: 1.18},
                            {x: 9, y: 1.32},
                            {x: 8, y: 1.05},
                            {x: 8, y: 1.21},
                            {x: 7, y: 1.15},
                            {x: 6, y: 1.08},
                            {x: 6, y: 1.42},
                            {x: 5, y: 0.95},
                            {x: 5, y: 1.28}
                        ],
                        backgroundColor: '#e74c3c'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '作业次数'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '平均用水量(吨)'
                            }
                        }
                    }
                }
            });
            
            // 操作人员工作分布
            const personnelCtx = document.getElementById('personnelChart').getContext('2d');
            new Chart(personnelCtx, {
                type: 'pie',
                data: {
                    labels: ['杨帅', '孙贝贝', '迟晓超', '黄雪丽', '邵一鸣', '其他'],
                    datasets: [{
                        data: [15, 12, 11, 10, 9, 43],
                        backgroundColor: [
                            '#3498db',
                            '#2ecc71',
                            '#e74c3c',
                            '#f39c12',
                            '#9b59b6',
                            '#95a5a6'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
            
            // 人员作业类型分布
            const personnelJobTypeCtx = document.getElementById('personnelJobTypeChart').getContext('2d');
            new Chart(personnelJobTypeCtx, {
                type: 'bar',
                data: {
                    labels: ['杨帅', '孙贝贝', '迟晓超', '黄雪丽', '邵一鸣'],
                    datasets: [
                        {
                            label: '测量作业',
                            data: [8, 6, 5, 4, 3],
                            backgroundColor: '#3498db'
                        },
                        {
                            label: '镟修作业',
                            data: [7, 6, 6, 6, 6],
                            backgroundColor: '#2ecc71'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '作业次数'
                            }
                        }
                    }
                }
            });
            
            // 月度平均用水量
            const waterUsageCtx = document.getElementById('waterUsageChart').getContext('2d');
            new Chart(waterUsageCtx, {
                type: 'bar',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月'],
                    datasets: [{
                        label: '平均用水量(吨)',
                        data: [1.41, 1.25, 1.18, 1.05, 1.15, 1.08, 0.95, 0.78, 0.85, 1.12],
                        backgroundColor: '#3498db'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '用水量(吨)'
                            }
                        }
                    }
                }
            });
            
            // 端洗与非端洗用水对比
            const endWashComparisonCtx = document.getElementById('endWashComparisonChart').getContext('2d');
            new Chart(endWashComparisonCtx, {
                type: 'bar',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月'],
                    datasets: [
                        {
                            label: '端洗',
                            data: [1.65, 1.52, 1.48, 1.35, 1.42, 1.38, 1.25, 1.08, 1.15, 1.32],
                            backgroundColor: '#e74c3c'
                        },
                        {
                            label: '非端洗',
                            data: [1.35, 1.18, 1.08, 0.95, 1.05, 0.98, 0.85, 0.68, 0.75, 1.02],
                            backgroundColor: '#3498db'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '用水量(吨)'
                            }
                        }
                    }
                }
            });
            
            // 作业效率趋势
            const efficiencyCtx = document.getElementById('efficiencyChart').getContext('2d');
            new Chart(efficiencyCtx, {
                type: 'line',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月'],
                    datasets: [
                        {
                            label: '镟修效率',
                            data: [75, 78, 82, 88, 85, 83, 80, 82, 84, 87],
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: '洗车效率',
                            data: [70, 72, 78, 85, 82, 80, 78, 85, 83, 80],
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            min: 60,
                            max: 100,
                            title: {
                                display: true,
                                text: '效率指数'
                            }
                        }
                    }
                }
            });
            
            // 用水效率分析
            const waterEfficiencyCtx = document.getElementById('waterEfficiencyChart').getContext('2d');
            new Chart(waterEfficiencyCtx, {
                type: 'line',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月'],
                    datasets: [{
                        label: '用水效率',
                        data: [65, 68, 75, 78, 76, 74, 72, 82, 79, 73],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            min: 60,
                            max: 90,
                            title: {
                                display: true,
                                text: '效率指数'
                            }
                        }
                    }
                }
            });
        }
        
        // 切换标签页
        function switchTab(tabName) {
            // 隐藏所有标签内容
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            // 移除所有标签的活动状态
            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            // 显示选中的标签内容
            document.getElementById(tabName).classList.add('active');
            
            // 设置选中的标签为活动状态
            event.currentTarget.classList.add('active');
        }
        
        // 页面加载完成后初始化
        window.onload = function() {
            initCharts();
        };
    </script>
</body>
</html>